CONFIG_KERNEL_BIN_NAME="vv"

CONFIG_FPU=y

#CONFIG_COUNTER_RTC_STM32=y
#CONFIG_COUNTER_RTC_STM32_SUBSECONDS=y
#CONFIG_LOG_TIMESTAMP_64BIT=y
# We run tickless, but this still provides a lower bound to the system time resolution
CONFIG_SYS_CLOCK_TICKS_PER_SEC=1000000
# ISRs are being built with a software shim. We can reduce latency by removing it, but
# isr_tables.c:.irq_info is missing, resulting in corruption of the irq table calculation.
#CONFIG_GEN_SW_ISR_TABLE=n
CONFIG_ISR_TABLES_LOCAL_DECLARATION=y
#CONFIG_ISR_TABLE_SHELL=y

CONFIG_GPIO=y
CONFIG_INPUT=y
CONFIG_I2C=y
CONFIG_SPI=y
CONFIG_SPI_LOG_LEVEL_INF=y
CONFIG_COUNTER=y
CONFIG_COUNTER_LOG_LEVEL_INF=y
CONFIG_ADC=y
CONFIG_ADC_LOG_LEVEL_DBG=y
CONFIG_DMA_LOG_LEVEL_INF=y
#CONFIG_ADC_STM32_DMA=y
CONFIG_ADC_STM32_DISABLE_IRQ=y
CONFIG_DAC=y
CONFIG_DAC_STM32_DMA=y
CONFIG_DAC_LOG_LEVEL_INF=y
CONFIG_DMA=y
CONFIG_FLASH=y
CONFIG_FLASH_LOG_LEVEL_INF=y
CONFIG_STM32_MEMMAP=y
CONFIG_FLASH_JESD216_API=y
CONFIG_UART_ASYNC_API=y
CONFIG_PWM=y
CONFIG_RTC=y
CONFIG_DSP=y
CONFIG_AUXDISPLAY=y
CONFIG_AUXDISPLAY_LOG_LEVEL_INF=y

CONFIG_LOG=y
#CONFIG_USE_STM32_ASSERT=y
#CONFIG_LOG_BACKEND_UART=y
#CONFIG_LOG_BACKEND_UART_ASYNC=y
#CONFIG_SHELL_LOG_BACKEND=n
#CONFIG_SHELL_BACKEND_SERIAL_API_POLLING=y
CONFIG_LOG_CMDS=y
CONFIG_LOG_MODE_IMMEDIATE=n
CONFIG_LOG_MODE_DEFERRED=y
CONFIG_LOG_THREAD_ID_PREFIX=y
CONFIG_LOG_PROCESS_THREAD_SLEEP_MS=100
CONFIG_LOG_BUFFER_SIZE=4096
#CONFIG_LOG_PROCESS_TRIGGER_THRESHOLD=10

# Bootloader: these need partition definitions in flash!
CONFIG_USE_DT_CODE_PARTITION=y
CONFIG_BOOTLOADER_MCUBOOT=y
CONFIG_MCUBOOT_GENERATE_UNSIGNED_IMAGE=y
CONFIG_MCUBOOT_IMG_MANAGER=y
CONFIG_RETAINED_MEM=y
CONFIG_RETENTION=y
CONFIG_RETENTION_BOOT_MODE=y
CONFIG_RETENTION_BOOTLOADER_INFO=y
#CONFIG_RETAINED_MEM_LOG_LEVEL_DBG=y
CONFIG_RETENTION_BOOTLOADER_INFO_TYPE_MCUBOOT=y

# Features
CONFIG_NOCACHE_MEMORY=y
CONFIG_CACHE_MANAGEMENT=y

# Provides spinlock checking
CONFIG_ASSERT=y
CONFIG_PRINTK_SYNC=y

CONFIG_CONSOLE_SUBSYS=y
CONFIG_HWINFO=y

CONFIG_STATS=y
CONFIG_RTIO=y
CONFIG_I2C_RTIO=y
CONFIG_SPI_RTIO=y

## Firmware upgrade
# There are several possible ways to implement firmware updates:
# 1) through MCUboot and DFU (or via serial recovery over ACM)
# 2) live over USB using DFU
# 3) live over serial using MCUMGR (see mcumgr-client, written in rust)
# of these DFU is probably most efficient but serial over USB likely
# requires less setup on the host machine.
#CONFIG_ZCBOR=y
#CONFIG_NETWORKING=y # Required for MCUMGR
#CONFIG_MCUMGR=y

CONFIG_IMG_MANAGER=y
CONFIG_MCUBOOT_SHELL=y
CONFIG_FLASH_MAP=y
CONFIG_FLASH_MAP_SHELL=y
CONFIG_STREAM_FLASH=y

## USB Support
# https://pid.codes/howto/: 0x1209
# https://github.com/obdev/v-usb/blob/master/usbdrv/USB-IDs-for-free.txt: 05dc:16c0 or 27d8:16c0 for libusb
# https://wiki.openmoko.org/wiki/USB_Product_IDs: 0x1457 (FIC, Inc) or 0x1d50 (Openmoko, Inc)
# In the future do we want to support using the device as an audio source?
#CONFIG_USB_DEVICE_STACK=y
#CONFIG_USB_DEVICE_VID=0x1209
# 'vv'
#CONFIG_USB_DEVICE_PID=0x7676
#CONFIG_USB_DEVICE_MANUFACTURER="Wagner Metalworks"
#CONFIG_USB_DEVICE_PRODUCT="Vestal Vamp"

## Application features
CONFIG_CMSIS_DSP=y
CONFIG_CMSIS_DSP_BASICMATH=y
CONFIG_CMSIS_DSP_COMPLEXMATH=y
CONFIG_CMSIS_DSP_FASTMATH=y
CONFIG_CMSIS_DSP_INTERPOLATION=y
CONFIG_CMSIS_DSP_SUPPORT=y
CONFIG_CMSIS_DSP_TRANSFORM=y
CONFIG_CMSIS_DSP_WINDOW=y

CONFIG_CPP=y
CONFIG_STD_CPP11=y
CONFIG_MINIMAL_LIBCPP=y

#CONFIG_NET_IPV4_IGMP=y

# Required for HTTP
#CONFIG_NET_SHELL=y
#CONFIG_NET_STATISTICS=y
#CONFIG_NET_L2_ETHERNET=y
#CONFIG_NET_IPV6=y
#CONFIG_NET_IPV4=y
#CONFIG_NET_DHCPV4=y
#CONFIG_NET_DHCPV6=y

#CONFIG_EVENTFD=y
#CONFIG_NET_SOCKETS=y
#CONFIG_NET_TCP=y
#CONFIG_FILE_SYSTEM=y
#CONFIG_HTTP_SERVER=y

# Services
CONFIG_BOOTARGS=y
CONFIG_SHELL=y
#CONFIG_ADC_SHELL=y
#CONFIG_COUNTER_SHELL=y
#CONFIG_DAC_SHELL=y
CONFIG_FLASH_SHELL=y
CONFIG_GPIO_SHELL=y
CONFIG_HWINFO_SHELL=y
#CONFIG_I2C_SHELL=y
#CONFIG_SPI_SHELL=y
CONFIG_STATS_SHELL=y
CONFIG_KERNEL_SHELL=y

CONFIG_I2C_STATS=y
CONFIG_SPI_STATS=y
CONFIG_THREAD_RUNTIME_STATS=y
CONFIG_SYS_HEAP_RUNTIME_STATS=y

# Debugging
CONFIG_DEBUG=y
CONFIG_DEBUG_THREAD_INFO=y
#CONFIG_OPENOCD=y
CONFIG_OUTPUT_SYMBOLS=y
CONFIG_THREAD_ANALYZER=y
